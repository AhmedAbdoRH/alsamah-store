# توثيق نظام معاينة الروابط (Social Previews)

تم استبدال نظام Prerender.io بنظام مخصص يعتمد على **Netlify Edge Functions**. هذا النظام أسرع، مجاني بالكامل، ولا يعتمد على خدمات خارجية قد تتوقف أو تصل للحد الأقصى.

## كيف يعمل النظام الجديد؟

1. عندما يقوم شخص بمشاركة رابط منتج على (واتساب، فيسبوك، تويتر، إلخ).
2. يقوم تطبيق التواصل الاجتماعي بإرسال "بوت" (Crawler) لقراءة الرابط.
3. تقوم **Edge Function** في نيتلفاي بالتعرف على هذا البوت.
4. تجلب الدالة بيانات المنتج (العنوان، الوصف، الصورة) مباشرة من **Supabase**.
5. تُرجع الدالة صفحة HTML بسيطة تحتوي على الوسوم (Meta Tags) المطلوبة فقط للمعاينة.
6. المستخدم العادي يكمل طريقه للموقع بشكل طبيعي دون أي تأخير.

## الإعدادات المطلوبة في Netlify

لضمان عمل النظام، يجب التأكد من وجود المتغيرات التالية في لوحة تحكم Netlify (**Site settings > Build & deploy > Environment variables**):

*   `VITE_SUPABASE_URL`: رابط مشروع Supabase الخاص بك.
*   `VITE_SUPABASE_ANON_KEY`: مفتاح المشروع العام (Anon Key).

## المسارات المدعومة حالياً

النظام يدعم تلقائياً الروابط التالية:
*   `/product/:id`
*   `/service/:id`
*   الصفحة الرئيسية (عبر وسم ثابت في `index.html`).

## ملاحظة هامة للواتساب
الواتساب يقوم أحياناً بحفظ (Cache) للمعاينة القديمة. إذا قمت بتغيير صورة منتج ولم تظهر فوراً، فقد تحتاج للانتظار أو تجربة رابط جديد.
